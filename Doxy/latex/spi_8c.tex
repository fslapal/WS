\hypertarget{spi_8c}{}\section{Arduino/\+Libraries/\+S\+P\+I/spi.c File Reference}
\label{spi_8c}\index{Arduino/\+Libraries/\+S\+P\+I/spi.\+c@{Arduino/\+Libraries/\+S\+P\+I/spi.\+c}}


S\+PI driver for A\+V\+R32 U\+C3.  


{\ttfamily \#include \char`\"{}spi.\+h\char`\"{}}\newline
Include dependency graph for spi.\+c\+:
% FIG 0
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
union \hyperlink{unionu__avr32__spi__cr__t}{u\+\_\+avr32\+\_\+spi\+\_\+cr\+\_\+t}
\item 
union \hyperlink{unionu__avr32__spi__mr__t}{u\+\_\+avr32\+\_\+spi\+\_\+mr\+\_\+t}
\item 
union \hyperlink{unionu__avr32__spi__tdr__t}{u\+\_\+avr32\+\_\+spi\+\_\+tdr\+\_\+t}
\item 
union \hyperlink{unionu__avr32__spi__ier__t}{u\+\_\+avr32\+\_\+spi\+\_\+ier\+\_\+t}
\item 
union \hyperlink{unionu__avr32__spi__idr__t}{u\+\_\+avr32\+\_\+spi\+\_\+idr\+\_\+t}
\item 
union \hyperlink{unionu__avr32__spi__csr__t}{u\+\_\+avr32\+\_\+spi\+\_\+csr\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{spi_8c_ae79ec729af0c69a648195985d70bc26b}{spi\+\_\+reset} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Resets the S\+PI controller. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_a1fc77d26387ef26a9b5020e4e04b3b2e}{spi\+\_\+init\+Slave} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned char bits, unsigned char spi\+\_\+mode)
\begin{DoxyCompactList}\small\item\em Initializes the S\+PI in slave mode. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_a04a1d45030965c52dc63b205166c61c1}{spi\+\_\+init\+Test} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Sets up the S\+PI in a test mode where the transmitter is connected to the receiver (local loopback). \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_a93b09f2d5b41fe71291968cd2658cba2}{spi\+\_\+init\+Master} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, const \hyperlink{structspi__options__t}{spi\+\_\+options\+\_\+t} $\ast$options)
\begin{DoxyCompactList}\small\item\em Initializes the S\+PI in master mode. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_ad76b44e99966bb6a66b122b44f64b928}{spi\+\_\+selection\+Mode} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned char variable\+\_\+ps, unsigned char pcs\+\_\+decode, unsigned char delay)
\begin{DoxyCompactList}\small\item\em Sets up how and when the slave chips are selected (master mode only). \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_af9d47e62b6b92aa3d786229c24584ae1}{spi\+\_\+select\+Chip} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned char chip)
\begin{DoxyCompactList}\small\item\em Selects slave chip. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_a6c7f9eff8ca5319ae5b998255d925a6a}{spi\+\_\+unselect\+Chip} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned char chip)
\begin{DoxyCompactList}\small\item\em Unselects slave chip. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_ab045d0326f18f12e846c6e54945c3c43}{spi\+\_\+setup\+Chip\+Reg} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, const \hyperlink{structspi__options__t}{spi\+\_\+options\+\_\+t} $\ast$options, unsigned int pba\+\_\+hz)
\begin{DoxyCompactList}\small\item\em Sets options for a specific slave chip. \end{DoxyCompactList}\item 
void \hyperlink{spi_8c_ac93e5990e8abc811f4ba2fb65e10e94d}{spi\+\_\+enable} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Enables the S\+PI. \end{DoxyCompactList}\item 
void \hyperlink{spi_8c_a5cc4ac60e6ecf3cdc442265aaa0a63e0}{spi\+\_\+disable} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Disables the S\+PI. \end{DoxyCompactList}\item 
int \hyperlink{spi_8c_aa945d35a658c234e2cb650a53dcdaa37}{spi\+\_\+is\+\_\+enabled} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Tests if the S\+PI is enabled. \end{DoxyCompactList}\item 
unsigned char \hyperlink{spi_8c_a4e0840fa276e1e4bfe182769d458f9d6}{spi\+\_\+write\+Register\+Empty\+Check} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Checks if there is no data in the transmit register. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_ab6ee194293396b8f0e47b914ff6a59a5}{spi\+\_\+write} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned short data)
\begin{DoxyCompactList}\small\item\em Writes one data word in master fixed peripheral select mode or in slave mode. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_afe820471bb3dd26fdd0f52cde696cf15}{spi\+\_\+variable\+Slave\+Write} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned short data, unsigned char pcs, unsigned char lastxfer)
\begin{DoxyCompactList}\small\item\em Selects a slave in master variable peripheral select mode and writes one data word to it. \end{DoxyCompactList}\item 
unsigned char \hyperlink{spi_8c_a3675facf1bb501f769ce8e9a3c2fc23f}{spi\+\_\+write\+End\+Check} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Checks if all transmissions are complete. \end{DoxyCompactList}\item 
unsigned char \hyperlink{spi_8c_a86f2b56ec7eeb0712ef0c5f43e9ae604}{spi\+\_\+read\+Register\+Full\+Check} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Checks if there is data in the receive register. \end{DoxyCompactList}\item 
\hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} \hyperlink{spi_8c_a37b77c1847803528025bd60897cc18e8}{spi\+\_\+read} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi, unsigned short $\ast$data)
\begin{DoxyCompactList}\small\item\em Reads one data word in master mode or in slave mode. \end{DoxyCompactList}\item 
unsigned char \hyperlink{spi_8c_a354beb51d8e5e95665c089832f3a8631}{spi\+\_\+get\+Status} (volatile avr32\+\_\+spi\+\_\+t $\ast$spi)
\begin{DoxyCompactList}\small\item\em Gets status information from the S\+PI. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+PI driver for A\+V\+R32 U\+C3. 

This file defines a useful set of functions for the S\+PI interface on A\+V\+R32 devices.


\begin{DoxyItemize}
\item Compiler\+: I\+AR E\+W\+A\+V\+R32 and G\+NU G\+CC for A\+V\+R32
\item Supported devices\+: All A\+V\+R32 devices with an S\+PI module can be used.
\item App\+Note\+:
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Atmel Corporation\+: \href{http://www.atmel.com}{\tt http\+://www.\+atmel.\+com} ~\newline
 Support and F\+AQ\+: \href{http://support.atmel.no/}{\tt http\+://support.\+atmel.\+no/} 
\end{DoxyAuthor}


\subsection{Function Documentation}
\mbox{\Hypertarget{spi_8c_a5cc4ac60e6ecf3cdc442265aaa0a63e0}\label{spi_8c_a5cc4ac60e6ecf3cdc442265aaa0a63e0}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+disable@{spi\+\_\+disable}}
\index{spi\+\_\+disable@{spi\+\_\+disable}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+disable()}{spi\_disable()}}
{\footnotesize\ttfamily void spi\+\_\+disable (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Disables the S\+PI. 

Ensures that nothing is transferred while setting up buffers.


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
This may cause data loss if used on a slave S\+PI. 
\end{DoxyWarning}
\mbox{\Hypertarget{spi_8c_ac93e5990e8abc811f4ba2fb65e10e94d}\label{spi_8c_ac93e5990e8abc811f4ba2fb65e10e94d}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+enable@{spi\+\_\+enable}}
\index{spi\+\_\+enable@{spi\+\_\+enable}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+enable()}{spi\_enable()}}
{\footnotesize\ttfamily void spi\+\_\+enable (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Enables the S\+PI. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{spi_8c_a354beb51d8e5e95665c089832f3a8631}\label{spi_8c_a354beb51d8e5e95665c089832f3a8631}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+get\+Status@{spi\+\_\+get\+Status}}
\index{spi\+\_\+get\+Status@{spi\+\_\+get\+Status}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+get\+Status()}{spi\_getStatus()}}
{\footnotesize\ttfamily unsigned char spi\+\_\+get\+Status (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Gets status information from the S\+PI. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+O\+V\+E\+R\+R\+UN} & Overrun error. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+M\+O\+D\+E\+\_\+\+F\+A\+U\+LT} & Mode fault (S\+PI addressed as slave while in master mode). \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N\+\_\+\+A\+N\+D\+\_\+\+M\+O\+D\+E\+\_\+\+F\+A\+U\+LT} & Overrun error and mode fault. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_a93b09f2d5b41fe71291968cd2658cba2}\label{spi_8c_a93b09f2d5b41fe71291968cd2658cba2}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+init\+Master@{spi\+\_\+init\+Master}}
\index{spi\+\_\+init\+Master@{spi\+\_\+init\+Master}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+init\+Master()}{spi\_initMaster()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+init\+Master (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{const \hyperlink{structspi__options__t}{spi\+\_\+options\+\_\+t} $\ast$}]{options }\end{DoxyParamCaption})}



Initializes the S\+PI in master mode. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em options} & Pointer to a structure containing initialization options.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_a1fc77d26387ef26a9b5020e4e04b3b2e}\label{spi_8c_a1fc77d26387ef26a9b5020e4e04b3b2e}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+init\+Slave@{spi\+\_\+init\+Slave}}
\index{spi\+\_\+init\+Slave@{spi\+\_\+init\+Slave}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+init\+Slave()}{spi\_initSlave()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+init\+Slave (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned char}]{bits,  }\item[{unsigned char}]{spi\+\_\+mode }\end{DoxyParamCaption})}



Initializes the S\+PI in slave mode. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em bits} & Number of bits in each transmitted character (8 to 16). \\
\hline
{\em spi\+\_\+mode} & Clock polarity and phase.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_a04a1d45030965c52dc63b205166c61c1}\label{spi_8c_a04a1d45030965c52dc63b205166c61c1}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+init\+Test@{spi\+\_\+init\+Test}}
\index{spi\+\_\+init\+Test@{spi\+\_\+init\+Test}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+init\+Test()}{spi\_initTest()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+init\+Test (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Sets up the S\+PI in a test mode where the transmitter is connected to the receiver (local loopback). 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_aa945d35a658c234e2cb650a53dcdaa37}\label{spi_8c_aa945d35a658c234e2cb650a53dcdaa37}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+is\+\_\+enabled@{spi\+\_\+is\+\_\+enabled}}
\index{spi\+\_\+is\+\_\+enabled@{spi\+\_\+is\+\_\+enabled}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+is\+\_\+enabled()}{spi\_is\_enabled()}}
{\footnotesize\ttfamily int spi\+\_\+is\+\_\+enabled (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Tests if the S\+PI is enabled. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily 1} if the S\+PI is enabled, otherwise {\ttfamily 0}. 
\end{DoxyReturn}
\mbox{\Hypertarget{spi_8c_a37b77c1847803528025bd60897cc18e8}\label{spi_8c_a37b77c1847803528025bd60897cc18e8}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+read@{spi\+\_\+read}}
\index{spi\+\_\+read@{spi\+\_\+read}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+read()}{spi\_read()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+read (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned short $\ast$}]{data }\end{DoxyParamCaption})}



Reads one data word in master mode or in slave mode. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em data} & Pointer to the location where to store the received data word.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+T\+I\+M\+E\+O\+UT} & Time-\/out.\\
\hline
\end{DoxyRetVals}
\begin{DoxyNote}{Note}
Will block program execution until time-\/out occurs if no data is received or last transmission is not complete. Invoke \hyperlink{spi_8h_a3675facf1bb501f769ce8e9a3c2fc23f}{spi\+\_\+write\+End\+Check} or \hyperlink{spi_8h_a86f2b56ec7eeb0712ef0c5f43e9ae604}{spi\+\_\+read\+Register\+Full\+Check} beforehand if needed. 
\end{DoxyNote}
\mbox{\Hypertarget{spi_8c_a86f2b56ec7eeb0712ef0c5f43e9ae604}\label{spi_8c_a86f2b56ec7eeb0712ef0c5f43e9ae604}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+read\+Register\+Full\+Check@{spi\+\_\+read\+Register\+Full\+Check}}
\index{spi\+\_\+read\+Register\+Full\+Check@{spi\+\_\+read\+Register\+Full\+Check}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+read\+Register\+Full\+Check()}{spi\_readRegisterFullCheck()}}
{\footnotesize\ttfamily unsigned char spi\+\_\+read\+Register\+Full\+Check (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Checks if there is data in the receive register. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & Some data in R\+DR. \\
\hline
{\em 0} & No data in R\+DR. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_ae79ec729af0c69a648195985d70bc26b}\label{spi_8c_ae79ec729af0c69a648195985d70bc26b}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+reset@{spi\+\_\+reset}}
\index{spi\+\_\+reset@{spi\+\_\+reset}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+reset()}{spi\_reset()}}
{\footnotesize\ttfamily void spi\+\_\+reset (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Resets the S\+PI controller. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{spi_8c_af9d47e62b6b92aa3d786229c24584ae1}\label{spi_8c_af9d47e62b6b92aa3d786229c24584ae1}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+select\+Chip@{spi\+\_\+select\+Chip}}
\index{spi\+\_\+select\+Chip@{spi\+\_\+select\+Chip}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+select\+Chip()}{spi\_selectChip()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+select\+Chip (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned char}]{chip }\end{DoxyParamCaption})}



Selects slave chip. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em chip} & Slave chip number (normal\+: 0 to 3, extarnally decoded signal\+: 0 to 14).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_ad76b44e99966bb6a66b122b44f64b928}\label{spi_8c_ad76b44e99966bb6a66b122b44f64b928}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+selection\+Mode@{spi\+\_\+selection\+Mode}}
\index{spi\+\_\+selection\+Mode@{spi\+\_\+selection\+Mode}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+selection\+Mode()}{spi\_selectionMode()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+selection\+Mode (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned char}]{variable\+\_\+ps,  }\item[{unsigned char}]{pcs\+\_\+decode,  }\item[{unsigned char}]{delay }\end{DoxyParamCaption})}



Sets up how and when the slave chips are selected (master mode only). 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em variable\+\_\+ps} & Target slave is selected in transfer register for every character to transmit. \\
\hline
{\em pcs\+\_\+decode} & The four chip select lines are decoded externally. Values 0 to 14 can be given to \hyperlink{spi_8h_af9d47e62b6b92aa3d786229c24584ae1}{spi\+\_\+select\+Chip}. \\
\hline
{\em delay} & Delay in P\+BA periods between chip selects.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_ab045d0326f18f12e846c6e54945c3c43}\label{spi_8c_ab045d0326f18f12e846c6e54945c3c43}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+setup\+Chip\+Reg@{spi\+\_\+setup\+Chip\+Reg}}
\index{spi\+\_\+setup\+Chip\+Reg@{spi\+\_\+setup\+Chip\+Reg}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+setup\+Chip\+Reg()}{spi\_setupChipReg()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+setup\+Chip\+Reg (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{const \hyperlink{structspi__options__t}{spi\+\_\+options\+\_\+t} $\ast$}]{options,  }\item[{unsigned int}]{pba\+\_\+hz }\end{DoxyParamCaption})}



Sets options for a specific slave chip. 

The baudrate field has to be written before transfer in master mode. Four similar registers exist, one for each slave. When using encoded slave addressing, reg=0 sets options for slaves 0 to 3, reg=1 for slaves 4 to 7 and so on.


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em options} & Pointer to a structure containing initialization options for an S\+PI channel. \\
\hline
{\em pba\+\_\+hz} & S\+PI module input clock frequency (P\+BA clock, Hz).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_a6c7f9eff8ca5319ae5b998255d925a6a}\label{spi_8c_a6c7f9eff8ca5319ae5b998255d925a6a}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+unselect\+Chip@{spi\+\_\+unselect\+Chip}}
\index{spi\+\_\+unselect\+Chip@{spi\+\_\+unselect\+Chip}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+unselect\+Chip()}{spi\_unselectChip()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+unselect\+Chip (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned char}]{chip }\end{DoxyParamCaption})}



Unselects slave chip. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em chip} & Slave chip number (normal\+: 0 to 3, extarnally decoded signal\+: 0 to 14).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+T\+I\+M\+E\+O\+UT} & Time-\/out.\\
\hline
\end{DoxyRetVals}
\begin{DoxyNote}{Note}
Will block program execution until time-\/out occurs if last transmission is not complete. Invoke \hyperlink{spi_8h_a3675facf1bb501f769ce8e9a3c2fc23f}{spi\+\_\+write\+End\+Check} beforehand if needed. 
\end{DoxyNote}
\mbox{\Hypertarget{spi_8c_afe820471bb3dd26fdd0f52cde696cf15}\label{spi_8c_afe820471bb3dd26fdd0f52cde696cf15}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+variable\+Slave\+Write@{spi\+\_\+variable\+Slave\+Write}}
\index{spi\+\_\+variable\+Slave\+Write@{spi\+\_\+variable\+Slave\+Write}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+variable\+Slave\+Write()}{spi\_variableSlaveWrite()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+variable\+Slave\+Write (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned short}]{data,  }\item[{unsigned char}]{pcs,  }\item[{unsigned char}]{lastxfer }\end{DoxyParamCaption})}



Selects a slave in master variable peripheral select mode and writes one data word to it. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em data} & The data word to write. \\
\hline
{\em pcs} & Slave selector (bit 0 -\/$>$ n\+CS line 0, bit 1 -\/$>$ n\+CS line 1, etc.). \\
\hline
{\em lastxfer} & Boolean indicating whether this is the last data word transfer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+T\+I\+M\+E\+O\+UT} & Time-\/out. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+A\+R\+G\+U\+M\+E\+NT} & Invalid argument(s) passed.\\
\hline
\end{DoxyRetVals}
\begin{DoxyNote}{Note}
Will block program execution until time-\/out occurs if transmitter is busy and transmit buffer is full. Invoke \hyperlink{spi_8h_a4e0840fa276e1e4bfe182769d458f9d6}{spi\+\_\+write\+Register\+Empty\+Check} beforehand if needed.

Once the data has been written to the transmit buffer, the end of transmission is not waited for. Invoke \hyperlink{spi_8h_a3675facf1bb501f769ce8e9a3c2fc23f}{spi\+\_\+write\+End\+Check} if needed. 
\end{DoxyNote}
\mbox{\Hypertarget{spi_8c_ab6ee194293396b8f0e47b914ff6a59a5}\label{spi_8c_ab6ee194293396b8f0e47b914ff6a59a5}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+write@{spi\+\_\+write}}
\index{spi\+\_\+write@{spi\+\_\+write}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+write()}{spi\_write()}}
{\footnotesize\ttfamily \hyperlink{spi_8h_a856ecadf3d7fe18c4fc3ae56500f8982}{spi\+\_\+status\+\_\+t} spi\+\_\+write (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi,  }\item[{unsigned short}]{data }\end{DoxyParamCaption})}



Writes one data word in master fixed peripheral select mode or in slave mode. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance. \\
\hline
{\em data} & The data word to write.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em S\+P\+I\+\_\+\+OK} & Success. \\
\hline
{\em S\+P\+I\+\_\+\+E\+R\+R\+O\+R\+\_\+\+T\+I\+M\+E\+O\+UT} & Time-\/out.\\
\hline
\end{DoxyRetVals}
\begin{DoxyNote}{Note}
Will block program execution until time-\/out occurs if transmitter is busy and transmit buffer is full. Invoke \hyperlink{spi_8h_a4e0840fa276e1e4bfe182769d458f9d6}{spi\+\_\+write\+Register\+Empty\+Check} beforehand if needed.

Once the data has been written to the transmit buffer, the end of transmission is not waited for. Invoke \hyperlink{spi_8h_a3675facf1bb501f769ce8e9a3c2fc23f}{spi\+\_\+write\+End\+Check} if needed. 
\end{DoxyNote}
\mbox{\Hypertarget{spi_8c_a3675facf1bb501f769ce8e9a3c2fc23f}\label{spi_8c_a3675facf1bb501f769ce8e9a3c2fc23f}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+write\+End\+Check@{spi\+\_\+write\+End\+Check}}
\index{spi\+\_\+write\+End\+Check@{spi\+\_\+write\+End\+Check}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+write\+End\+Check()}{spi\_writeEndCheck()}}
{\footnotesize\ttfamily unsigned char spi\+\_\+write\+End\+Check (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Checks if all transmissions are complete. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & All transmissions complete. \\
\hline
{\em 0} & Transmissions not complete. \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{spi_8c_a4e0840fa276e1e4bfe182769d458f9d6}\label{spi_8c_a4e0840fa276e1e4bfe182769d458f9d6}} 
\index{spi.\+c@{spi.\+c}!spi\+\_\+write\+Register\+Empty\+Check@{spi\+\_\+write\+Register\+Empty\+Check}}
\index{spi\+\_\+write\+Register\+Empty\+Check@{spi\+\_\+write\+Register\+Empty\+Check}!spi.\+c@{spi.\+c}}
\subsubsection{\texorpdfstring{spi\+\_\+write\+Register\+Empty\+Check()}{spi\_writeRegisterEmptyCheck()}}
{\footnotesize\ttfamily unsigned char spi\+\_\+write\+Register\+Empty\+Check (\begin{DoxyParamCaption}\item[{volatile avr32\+\_\+spi\+\_\+t $\ast$}]{spi }\end{DoxyParamCaption})}



Checks if there is no data in the transmit register. 


\begin{DoxyParams}{Parameters}
{\em spi} & Base address of the S\+PI instance.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & No data in T\+DR. \\
\hline
{\em 0} & Some data in T\+DR. \\
\hline
\end{DoxyRetVals}
